<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{base::layout(~{::section})}">
<head>
	<meta charset="UTF-8">
	<title th:text="${userType == 1 ? 'Manage Customers' : (userType == 2 ? 'Manage Admins' : 'Manage Users')} + ' - TechZone Admin'"></title>
	<style>
		.admin-table thead th {
			background-color: #343a40;
			color: white;
			font-weight: 600;
			vertical-align: middle;
			font-size: 0.9rem;
			white-space: nowrap;
			padding: 0.75rem 0.5rem;
		}
		.admin-table tbody td {
			vertical-align: middle;
			font-size: 0.85rem;
			padding: 0.5rem;
		}
		.admin-table .address-cell {
			min-width: 200px;
			white-space: normal;
			word-break: break-word;
		}
		.admin-table .status-badge {
			font-size: 0.75em;
			padding: 0.3em 0.6em !important;
		}
		.admin-table .action-buttons .btn {
			margin-right: 0.2rem;
			margin-bottom: 0.2rem;
			padding: 0.15rem 0.4rem;
			font-size: 0.7rem;
		}
		.admin-table .text-center-col {
			text-align: center;
		}
	</style>
</head>
<body>
<section>
	<div class="container my-4">
		<div class="card shadow-sm border-0">
			<div class="card-header bg-light d-flex justify-content-between align-items-center p-3">
				<div class="d-flex align-items-center">
					<a th:href="@{/admin/}" class="btn btn-sm btn-outline-secondary me-2">
						<i class="fas fa-arrow-left"></i> Back
					</a>
					<h4 class="mb-0 fw-bold d-flex align-items-center">
						<i th:if="${userType==1}" class="fas fa-users me-2 text-primary"></i>
						<i th:if="${userType==2}" class="fas fa-user-shield me-2 text-secondary"></i>
						<span th:text="${userType==1 ? 'Customer List' : (userType==2 ? 'Admin List' : 'User List')}"></span>
					</h4>
				</div>
				<a th:if="${userType==1}" th:href="@{/admin/add-user}" class="btn btn-sm btn-primary">
					<i class="fas fa-plus me-1"></i> Add Customer
				</a>
				<a th:if="${userType==2}" th:href="@{/admin/add-admin}" class="btn btn-sm btn-secondary">
					<i class="fas fa-user-plus me-1"></i> Add Admin
				</a>
			</div>

			<div class="card-body p-0">
				<div class="m-3">
					<th:block th:if="${session.succMsg}">...</th:block>
					<th:block th:if="${session.errorMsg}">...</th:block>
				</div>

				<div class="table-responsive">
					<table class="table table-hover table-striped admin-table mb-0">
						<thead class="text-center-col">
						<tr>
							<th style="width: 5%;">#</th>
							<th>Name</th>
							<th>Email</th>
							<th>Mobile</th>
							<th style="width: 30%;">Address</th>
							<th style="width: 10%;">Status</th>
							<th style="width: 15%;">Actions</th>
						</tr>
						</thead>
						<tbody>
						<tr th:if="${users == null or users.isEmpty()}">
							<td colspan="7" class="text-center text-muted p-4">No users found.</td>
						</tr>
						<tr th:each="u, iterStat : ${users}">
							<td class="text-center-col">[[${iterStat.count}]]</td>
							<!-- Bỏ td của ảnh -->
							<td>[[${u.name}]]</td>
							<td>[[${u.email}]]</td>
							<td class="text-center-col">[[${u.mobileNumber ?: '-'}]]</td>
							<td class="address-cell">[[${u.address ?: ''}]], [[${u.city ?: ''}]], [[${u.state ?: ''}]] [[${u.pincode ?: ''}]]</td>
							<td class="text-center-col">
								<span th:if="${u.isEnable}" class="badge bg-success rounded-pill status-badge">Active</span>
								<span th:unless="${u.isEnable}" class="badge bg-danger rounded-pill status-badge">Inactive</span>
							</td>
							<td class="text-center-col action-buttons">
								<a th:href="@{'/admin/edit-user/' + ${u.id} + '?type=' + ${userType}}" class="btn btn-info" title="Edit User"><i class="fas fa-edit"></i></a>
								<a th:if="${u.isEnable}" th:href="@{'/admin/updateSts?status=false&id='+${u.id}+'&type='+${userType}}" class="btn btn-warning" title="Deactivate User"><i class="fas fa-toggle-off"></i></a>
								<a th:unless="${u.isEnable}" th:href="@{'/admin/updateSts?status=true&id='+${u.id}+'&type='+${userType}}" class="btn btn-success" title="Activate User"><i class="fas fa-toggle-on"></i></a>
							<a href="#"
								   th:attr="data-delete-url=@{/admin/delete-user/{id}(id=${u.id}, type=${userType})}"
								   onclick="confirmDelete(this.getAttribute('data-delete-url')); return false;"
								   class="btn btn-danger" title="Delete User">
									<i class="fas fa-trash-alt"></i>
								</a>
							</td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>

	<script th:inline="javascript">
		function confirmDelete(deleteUrl) {
			if (confirm("Are you sure you want to delete this user? This action cannot be undone.")) {
				window.location.href = deleteUrl;
			}
		}
		/*]]>*/
	</script>

</section>
</body>
</html>