<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{base::layout(~{::section})}">
<head>
	<meta charset="UTF-8">
	<title>All Products</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
	<script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>
</head>
<body>
<section>
	<div class="container-fluid mt-4 p-3">
		<div class="row">
			<div class="col-12 mb-3 text-center">
				<h2 class="fw-bold">All Products</h2>
				<hr>
			</div>

			<div class="col-12 mb-3">
				<a href="/admin/" class="btn btn-outline-secondary">
					<i class="fa-solid fa-arrow-left"></i> Back
				</a>
			</div>

			<!-- Session Messages -->
			<div th:if="${session.succMsg}" class="alert alert-success text-center" role="alert">
				[[${session.succMsg}]]
				<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
			</div>
			<div th:if="${session.errorMsg}" class="alert alert-danger text-center" role="alert">
				[[${session.errorMsg}]]
				<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
			</div>

			<!-- Search Form -->
			<div class="col-md-6 offset-md-3 mb-4">
				<form action="/admin/products" method="get" class="d-flex">
					<input type="text" class="form-control me-2 rounded" name="ch" placeholder="Search products...">
					<button class="btn btn-primary">Search</button>
				</form>
			</div>

			<!-- Product Table -->
			<div class="col-12">
				<div class="table-responsive">
					<table class="table table-hover align-middle text-center">
						<thead class="table-light">
						<tr>
							<th>Sl No</th>
							<th>Image</th>
							<th>Title</th>
							<th>Category</th>
							<th>Price</th>
							<th>Discount</th>
							<th>Discount Price</th>
							<th>Status</th>
							<th>Stock</th>
							<th>Action</th>
						</tr>
						</thead>
						<tbody>
						<tr th:each="p, c : ${products}">
							<th scope="row">[[${c.count}]]</th>
							<td>
								<img th:src="@{'/img/product_img/' + ${p.image}}" width="70" height="70" class="rounded">
							</td>
							<td>[[${p.title}]]</td>
							<td>[[${p.category}]]</td>
							<td>[[${p.price}]] VND</td>
							<td>[[${p.discount}]]%</td>
							<td>[[${p.discountPrice}]] VND</td>
							<td>
										<span th:classappend="${p.isActive} == 'Active' ? 'badge bg-success' : 'badge bg-secondary'">
											[[${p.isActive}]]
										</span>
							</td>
							<td>[[${p.stock}]]</td>
							<td>
								<div class="d-flex justify-content-center gap-2">
									<a th:href="@{'/admin/editProduct/' + ${p.id}}" class="btn btn-sm btn-primary">
										<i class="fa-solid fa-pen-to-square"></i> Edit
									</a>
									<a th:href="@{'/admin/deleteProduct/' + ${p.id}}" class="btn btn-sm btn-danger">
										<i class="fa-solid fa-trash"></i> Delete
									</a>
								</div>
							</td>
						</tr>
						</tbody>
					</table>
				</div>

				<!-- Pagination and Total -->
				<div class="row align-items-center mt-4 pt-3 border-top">
					<div class="col-md-4 text-center text-md-start mb-2 mb-md-0">
						<span class="text-muted small">Total Products: [[${totalElements}]]</span>
					</div>
					<div class="col-md-4 d-flex justify-content-center">
						<nav aria-label="Page navigation">
							<ul class="pagination  mb-0">
								<!-- Previous -->
								<li class="page-item" th:classappend="${isFirst} ? 'disabled'">
									<a class="page-link"
									   th:href="${!isFirst} ? @{/admin/products(pageNo=${pageNo-1}, ch=${param.ch})} : '#'"
									   aria-label="Previous"
									   th:attr="aria-disabled=${isFirst} ? 'true' : 'false'"
									   th:styleappend="${isFirst} ? 'pointer-events: none;' : ''">
										<i class="fas fa-angle-left"></i>
									</a>
								</li>

								<li th:each="i : ${#numbers.sequence(1, totalPages)}"
									class="page-item"
									th:classappend="${pageNo+1 == i} ? 'active'">
									<a class="page-link" th:href="@{/admin/products(pageNo=${i-1}, ch=${param.ch})}">
										[[${i}]]
									</a>
								</li>

								<!-- Next -->
								<li class="page-item" th:classappend="${isLast} ? 'disabled'">
									<a class="page-link"
									   th:href="${!isLast} ? @{/admin/products(pageNo=${pageNo+1}, ch=${param.ch})} : '#'"
									   aria-label="Next"
									   th:attr="aria-disabled=${isLast} ? 'true' : 'false'"
									   th:styleappend="${isLast} ? 'pointer-events: none;' : ''">
										<i class="fas fa-angle-right"></i>
									</a>
								</li>
							</ul>
						</nav>
					</div>
					<div class="col-md-4"></div>
				</div>


			</div>


		</div>
	</div>
</section>
</body>
</html>
